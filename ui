#
#POUR DEPLOYER APPLICATION EN LIGNE
# 
# setwd("~/CARTOBCR")
#  rsconnect::deployApp("CARTOBCR")


# This is the user-interface definition of a Shiny web application. You can
# run the application by clicking 'Run App' above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#

# install.packages('rsconnect')
# install.packages("anyLib")
# anyLib::anyLib(c("shiny", "shinydashboard", "shinyWidgets", "DT", "plotly", "ggplot2", "googleVis", "colourpicker"))
library(shinyWidgets)
library(shiny)
library(shinydashboard)
library(DT)
library(birdring)
library(rsconnect)
library(ggplot2)

# Define UI for application that draws a histogram
ui <- dashboardPage(
  dashboardHeader(title="Cartographie"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Lecture des donnees", tabName = "readData", icon = icon("readme")),
      menuItem("Visualisation des donnees", tabName = "visualization", icon = icon("poll")),
      menuItem("Selection des donnees", tabName = "Selection", icon = icon("poll")),
      menuItem("Cartographie", tabName = "Mapping", icon = icon("poll")),
      menuItem("References", tabName = "Ref", icon = icon("poll"))
    )
    
  ),
  dashboardBody(
    
    tabItems(
      # Read data
      tabItem(tabName = "readData",
              h1("Lecture des donnees"),
              fileInput("dataFile",label = NULL, 
                        buttonLabel = "Importer...",
                        placeholder = "Pas de fichier selectionne"),
              
              tags$br(),
              h5("1 - Importez votre ficher de donnees extrait par le CRBPO et converti en .CVS"),
              h5("2 - Verifiez que les donnees sont bien importees dans l apercu si-dessous"),
              h5("3 - Si tout vous semble correct, validez avec le bouton ci-dessous"),
              div(actionButton(inputId = "actBtnVisualisation", label = "Le tableau est correct",icon = icon("play") )),
              
              h3("Apercu des 10 premieres lignes"),
              dataTableOutput(outputId = "preview")

      ),
    
      
      # visualization
      tabItem(tabName = "visualization",
              h1("Visualisation des donnees"),
              h2("Exploration du tableau"),
              dataTableOutput('dataTable')
      ),

      #Selection #CETTE PARTIE NE FONCTIONNE PAS JE NE SAIS PAS COMMENT IMPORTER LES NOMS DES ESPECES
      tabItem(tabName = "Selection",
              h1("Selection des donnees"),
              checkboxGroupInput("checkGroup", 
                                 h3("Choix des annees"), 
                                 choices = list("Choice 1" = 1, 
                                                "Choice 2" = 2, 
                                                "Choice 3" = 3),
                                 selected = 10),
              checkboxGroupInput("checkGroup",
                                 h3("Choix des especes"),
                               # choices =  names(sp)) ,
                                 selected = 10)
  
      ),
      
      #Cartographie
      #rappel des filtres selectionnes 
      tabItem(tabName = "Mapping",
              h1("Cartographie"),
              h6("la carte va s'afficher dans quelques secondes"),
              h5("Rappel des parametres annee site espece"),
              downloadButton("downloadPlot", "Telecharger carte"),
              fluidRow(
                column(10,plotOutput("plotAvecR",width = "100%", height = "600px") )
              )
      ),
     
       #References
      #CHERCHER COMMENT CREER UN LIEN
       tabItem(tabName = "Ref",
                      h1("References"),
                      h5("Cette application a ete realisee par Milena Cairo et Manon Ghislain"),
                      h5("Contact : milena.cairo1@mnhn.fr et manon.ghislain@mnhn.fr"),
                      h5("Reference au package")

      )
      )
    )
    
    
  )
